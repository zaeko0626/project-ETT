<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ETT PPE System</title>

  <!-- Optional icons/fonts -->
  <link rel="stylesheet" href="styles.css?v=20260304_9" />
</head>
<body>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="overlay hidden">
    <div class="loader-card">
      <div class="spinner"></div>
      <div class="loader-text">Түр хүлээнэ үү…</div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal-overlay" class="overlay hidden">
    <div class="modal">
      <div class="modal-head">
        <div id="modal-title" class="modal-title"></div>
        <button class="icon-btn" onclick="closeModal()">✕</button>
      </div>
      <div id="modal-body" class="modal-body"></div>
    </div>
  </div>

  <!-- LOGIN -->
  <section id="login-page" class="page">
    <div class="login-card">
      <div class="brand">ETT PPE System</div>
      <div class="muted">Код, нууц үгээ оруулна уу</div>

      <label class="lbl">Код</label>
      <input id="login-user" class="inp" placeholder="Ж: 10001" autocomplete="username" />

      <label class="lbl">Нууц үг</label>
      <input id="login-pass" class="inp" type="password" placeholder="•••••" autocomplete="current-password" />

      <button class="btn primary" onclick="handleLogin()">Нэвтрэх</button>

      <div class="hint">
        Admin demo: <b>admin</b> / <b>12345</b>
      </div>
    </div>
  </section>

  <!-- MAIN -->
  <section id="main-page" class="page hidden">
    <header class="topbar">
      <button class="icon-btn" onclick="toggleSidebar()">☰</button>
      <div class="top-title">
        <div class="title">ETT PPE</div>
        <div id="user-display-name" class="subtitle hidden"></div>
      </div>
      <button class="btn ghost" onclick="logout()">Гарах</button>
    </header>

    <div class="layout">
      <!-- Sidebar -->
      <aside id="sidebar" class="sidebar">
        <div class="usercard">
          <div id="sb-name" class="uc-name"></div>
          <div id="sb-id" class="uc-id"></div>
          <div id="sb-role" class="uc-role"></div>
          <div id="sb-extra" class="uc-extra"></div>
        </div>

        <div class="nav">
          <button class="nav-btn active" id="nav-orders" onclick="showTab('orders', this)">Захиалга</button>
          <button class="nav-btn" id="nav-request" onclick="showTab('request', this)">Хүсэлт</button>
          <button class="nav-btn hidden" id="nav-items" onclick="showTab('items', this)">Бараа (Admin)</button>
        </div>

        <div class="side-actions">
          <button class="btn ghost" onclick="refreshData()">Дахин ачаалах</button>
        </div>
      </aside>

      <div id="sidebar-overlay" class="sidebar-overlay" onclick="closeSidebar()"></div>

      <!-- Content -->
      <main class="content">
        <!-- Orders tab -->
        <section id="tab-orders" class="tab-content">
          <div class="section-head">
            <div class="h1">Захиалгууд</div>
          </div>

          <div class="filters">
            <input id="search-name" class="inp" placeholder="Нэрээр хайх" oninput="applyFilters()" />
            <input id="search-code" class="inp" placeholder="Кодоор хайх" oninput="applyFilters()" />
            <input id="search-role" class="inp" placeholder="Албан тушаал" oninput="applyFilters()" />

            <select id="filter-item" class="inp" onchange="applyFilters()"></select>
            <select id="filter-status" class="inp" onchange="applyFilters()">
              <option value="">БҮХ ТӨЛӨВ</option>
              <option value="Хүлээгдэж буй">Хүлээгдэж буй</option>
              <option value="Зөвшөөрсөн">Олгосон</option>
              <option value="Татгалзсан">Татгалзсан</option>
            </select>

            <select id="filter-year" class="inp" onchange="applyFilters()"></select>
            <select id="filter-month" class="inp" onchange="applyFilters()"></select>

            <select id="filter-place" class="inp" onchange="onPlaceChange()"></select>
            <select id="filter-dept" class="inp" onchange="applyFilters()"></select>
            <select id="filter-shift" class="inp" onchange="applyFilters()"></select>
          </div>

          <div id="orders-list-container" class="list"></div>
        </section>

        <!-- Request tab -->
        <section id="tab-request" class="tab-content hidden">
          <div class="section-head">
            <div class="h1">PPE хүсэлт</div>
            <div class="muted">Бараа сонгоод хүсэлт илгээнэ</div>
          </div>

          <div class="card">
            <label class="lbl">Бараа</label>
            <select id="req-item" class="inp" onchange="updateSizeOptions()"></select>

            <label class="lbl">Размер</label>
            <select id="req-size" class="inp"></select>

            <label class="lbl">Тоо</label>
            <input id="req-qty" class="inp" type="number" min="1" value="1" />

            <button class="btn primary" onclick="submitRequest()">Илгээх</button>
          </div>
        </section>

        <!-- Items tab (Admin) -->
        <section id="tab-items" class="tab-content hidden">
          <div class="section-head">
            <div class="h1">Бараа (Admin)</div>
            <div class="row">
              <div id="items-count" class="muted"></div>
              <div class="row">
                <select id="items-filter-name" class="inp" onchange="renderItemsList()"></select>
                <button class="btn ghost" onclick="clearItemsFilter()">Цэвэрлэх</button>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="h2">Шинэ бараа нэмэх</div>
            <label class="lbl">Нэр</label>
            <input id="new-item-name" class="inp" placeholder="Ж: Ажлын гутал" />

            <label class="lbl">Размерууд (таслалаар)</label>
            <input id="new-item-sizes" class="inp" placeholder="Ж: 39,40,41,42" />

            <button class="btn primary" onclick="addItem()">Нэмэх</button>
          </div>

          <div id="items-list-container" class="list"></div>
        </section>

      </main>
    </div>
  </section>

  <script src="./app.js?v=20260304_9"></script>
</body>
</html>
