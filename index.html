<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ETT PPE System</title>

  <link rel="stylesheet" href="./styles.css?v=20260304" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>

<body>
  <!-- Loading -->
  <div id="loading-overlay" class="hidden">
    <div class="loader-card">
      <div class="loader-title">ТҮР ХҮЛЭЭНЭ ҮҮ...</div>
      <div class="loader-excavator">
        <div class="track"></div>
        <div class="excavator">⛏️</div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal-overlay" class="hidden" onclick="closeModal()">
    <div class="modal-card" onclick="event.stopPropagation()">
      <div class="modal-header">
        <div id="modal-title" class="modal-title">Modal</div>
        <button class="modal-x" aria-label="Close" onclick="closeModal()">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div class="modal-body" id="modal-body"></div>
    </div>
  </div>

  <!-- Sidebar overlay -->
  <div id="sidebar-overlay" onclick="toggleSidebar(false)"></div>

  <!-- Sidebar -->
  <aside id="sidebar">
    <div class="sidebar-inner">
      <div class="sidebar-scroll">
        <div class="sb-card">
          <div class="sb-name" id="sb-name">ETT PPE SYSTEM</div>
          <div class="sb-id" id="sb-id"></div>
          <div class="sb-role" id="sb-role"></div>
          <div class="sb-extra" id="sb-extra"></div>
        </div>

        <div style="margin-top:10px;font-weight:900;font-size:11px;letter-spacing:.08em;text-transform:uppercase;color:#93c5fd">
          Үндсэн цэс
        </div>

        <button class="nav-btn active" data-tab="orders" onclick="showTab('orders')">
          <i class="fa-solid fa-list-check"></i>
          <div class="nav-text">Жагсаалт</div>
        </button>

        <button class="nav-btn" data-tab="request" onclick="showTab('request')">
          <i class="fa-solid fa-file-circle-plus"></i>
          <div class="nav-text">Хүсэлт гаргах</div>
        </button>

        <button class="nav-btn" data-tab="items" onclick="showTab('items')">
          <i class="fa-solid fa-boxes-stacked"></i>
          <div class="nav-text">Барааны мэдээлэл</div>
        </button>

        <!-- ✅ Employees menu (admin only - app.js hide/show) -->
        <button class="nav-btn" id="nav-employees" data-tab="employees" onclick="showTab('employees')">
          <i class="fa-solid fa-users"></i>
          <div class="nav-text">Ажилтны мэдээлэл</div>
        </button>

        <button class="nav-btn" data-tab="password" onclick="showTab('password')">
          <i class="fa-solid fa-key"></i>
          <div class="nav-text">Нууц үг</div>
        </button>
      </div>

      <div class="sidebar-footer">
        <button class="logout-btn" onclick="logout()">
          <i class="fa-solid fa-right-from-bracket"></i>
          ГАРАХ
        </button>
      </div>
    </div>
  </aside>

  <!-- Header -->
  <header class="app-header">
    <button class="header-btn" onclick="toggleSidebar()">
      <i class="fa-solid fa-bars"></i>
    </button>

    <div class="app-title">ETT PPE SYSTEM</div>

    <button class="header-btn refresh-btn" onclick="refreshData()">
      <i class="fa-solid fa-rotate"></i>
      <span class="refresh-text">СЭРГЭЭХ</span>
    </button>
  </header>

  <!-- Main -->
  <main class="scroll-area">
    <!-- ORDERS -->
    <section id="tab-orders" class="tab">
      <div class="tab-top">
        <div class="tab-title">ЖАГСААЛТ</div>
      </div>

      <!-- ✅ Filters (3 rows layout): 1) status,item,year,month 2) place,dept,shift 3) name,code,role -->
      <div class="card card-compact">
        <div class="filters-grid">
          <div class="filter-group">
            <span class="filter-label">Төлөв</span>
            <select id="f-status"></select>
          </div>
          <div class="filter-group">
            <span class="filter-label">Бараа</span>
            <select id="f-item"></select>
          </div>
          <div class="filter-group">
            <span class="filter-label">Он</span>
            <select id="f-year"></select>
          </div>
          <div class="filter-group">
            <span class="filter-label">Сар</span>
            <select id="f-month"></select>
          </div>

          <div class="filter-group">
            <span class="filter-label">Газар</span>
            <select id="f-place"></select>
          </div>
          <div class="filter-group">
            <span class="filter-label">Хэлтэс</span>
            <select id="f-dept"></select>
          </div>
          <div class="filter-group">
            <span class="filter-label">Ээлж</span>
            <select id="f-shift"></select>
          </div>

          <div class="filter-group">
            <span class="filter-label">Нэрээр хайх</span>
            <input id="f-name" placeholder="Жишээ нь: Бат" />
          </div>
          <div class="filter-group">
            <span class="filter-label">Кодоор хайх</span>
            <input id="f-code" placeholder="Жишээ нь: 12345" />
          </div>
          <div class="filter-group">
            <span class="filter-label">Албан тушаал</span>
            <input id="f-role" placeholder="Жишээ нь: Машинист" />
          </div>

          <div class="filter-group">
            <span class="filter-label">&nbsp;</span>
            <button class="btn-mini edit" onclick="clearOrderFilters()">ЦЭВЭРЛЭХ</button>
          </div>
        </div>
      </div>

      <div id="orders-list"></div>
    </section>

    <!-- REQUEST -->
    <section id="tab-request" class="tab hidden">
      <div class="tab-top">
        <div class="tab-title">ШИНЭ ХҮСЭЛТ</div>
      </div>

      <div class="card">
        <div class="form-grid">
          <div>
            <span class="filter-label">Бараа</span>
            <select id="req-item"></select>
          </div>
          <div>
            <span class="filter-label">Хэмжээ</span>
            <select id="req-size"></select>
          </div>
          <div>
            <span class="filter-label">Тоо</span>
            <input id="req-qty" type="number" min="1" value="1" />
          </div>
          <div style="display:flex;align-items:flex-end">
            <button class="btn-primary" onclick="submitOrder()">ИЛГЭЭХ</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ITEMS -->
    <section id="tab-items" class="tab hidden">
      <div class="tab-top">
        <div class="tab-title">БАРААНЫ МЭДЭЭЛЭЛ</div>
      </div>

      <div class="card card-add-item" id="items-add-card">
        <div style="display:flex;gap:12px;align-items:center">
          <div class="add-icon"><i class="fa-solid fa-plus"></i></div>
          <div style="flex:1">
            <div class="filter-label" style="font-size:10px;color:#0f172a;margin:0 0 6px 0">Бараа нэмэх</div>
            <div class="form-grid" style="grid-template-columns:1fr 1fr 160px">
              <input id="new-item-name" placeholder="Жишээ нь: Гутал" />
              <input id="new-item-sizes" placeholder="Жишээ нь: 38,39,40" />
              <button class="btn-mini edit" onclick="addItem()">НЭМЭХ</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card card-compact">
        <div class="form-grid" style="grid-template-columns:1fr 160px">
          <div>
            <span class="filter-label">Бараа шүүх</span>
            <select id="items-filter"></select>
          </div>
          <div style="display:flex;align-items:flex-end">
            <button class="btn-mini edit" onclick="clearItemsFilter()">ЦЭВЭРЛЭХ</button>
          </div>
        </div>
      </div>

      <div class="items-head">
        <div>#</div>
        <div>БАРАА</div>
        <div>РАЗМЕР</div>
        <div style="text-align:right">ҮЙЛДЭЛ</div>
      </div>

      <div id="items-list"></div>
    </section>

    <!-- EMPLOYEES (admin) -->
    <section id="tab-employees" class="tab hidden">
      <div class="tab-top">
        <div class="tab-title">АЖИЛТНЫ МЭДЭЭЛЭЛ</div>
      </div>

      <div class="card card-add-item" id="emp-add-card">
        <div style="display:flex;gap:12px;align-items:center">
          <div class="add-icon"><i class="fa-solid fa-user-plus"></i></div>
          <div style="flex:1">
            <div class="filter-label" style="font-size:10px;color:#0f172a;margin:0 0 6px 0">Ажилтан нэмэх</div>

            <div class="form-grid">
              <input id="emp-code" placeholder="Код (Жишээ нь: 12345)" />
              <input id="emp-pass" placeholder="Нууц үг (Жишээ нь: 12345)" />
              <input id="emp-ovog" placeholder="Овог (Жишээ нь: Бат)" />
              <input id="emp-ner" placeholder="Нэр (Жишээ нь: Дорж)" />

              <input id="emp-role" placeholder="Албан тушаал (Жишээ нь: Машинист)" />
              <input id="emp-place" placeholder="Газар (Жишээ нь: Уурхай)" />
              <input id="emp-dept" placeholder="Хэлтэс (Жишээ нь: Засвар)" />

              <select id="emp-shift">
                <option value="">Ээлж (сонгох)</option>
                <option>А</option>
                <option>Б</option>
                <option>Өдөр</option>
                <option>Шөнө</option>
              </select>

              <button class="btn-mini edit" onclick="addEmployee()">НЭМЭХ</button>
            </div>
          </div>
        </div>
      </div>

      <div class="card card-compact" id="emp-filters-card">
        <div class="filters-grid" style="grid-template-columns:repeat(4,minmax(0,1fr))">
          <div class="filter-group">
            <span class="filter-label">Албан тушаал</span>
            <input id="ef-role" placeholder="Жишээ нь: Машинист" />
          </div>
          <div class="filter-group">
            <span class="filter-label">Газар</span>
            <input id="ef-place" placeholder="Жишээ нь: Уурхай" />
          </div>
          <div class="filter-group">
            <span class="filter-label">Хэлтэс</span>
            <input id="ef-dept" placeholder="Жишээ нь: Засвар" />
          </div>
          <div class="filter-group">
            <span class="filter-label">Ээлж</span>
            <select id="ef-shift">
              <option value="">Бүгд</option>
              <option>А</option>
              <option>Б</option>
              <option>Өдөр</option>
              <option>Шөнө</option>
            </select>
          </div>
          <div class="filter-group">
            <span class="filter-label">&nbsp;</span>
            <button class="btn-mini edit" onclick="clearEmployeeFilters()">ЦЭВЭРЛЭХ</button>
          </div>
        </div>
      </div>

      <div id="employees-list"></div>
    </section>

    <!-- PASSWORD -->
    <section id="tab-password" class="tab hidden">
      <div class="tab-top">
        <div class="tab-title">НУУЦ ҮГ СОЛИХ</div>
      </div>

      <div class="card">
        <div class="form-grid" style="grid-template-columns:1fr 1fr 1fr 180px">
          <div>
            <span class="filter-label">Хуучин нууц үг</span>
            <input id="old-pass" type="password" />
          </div>
          <div>
            <span class="filter-label">Шинэ нууц үг</span>
            <input id="new-pass" type="password" />
          </div>
          <div>
            <span class="filter-label">Шинэ нууц үг давтах</span>
            <input id="new-pass2" type="password" />
          </div>
          <div style="display:flex;align-items:flex-end">
            <button class="btn-primary" onclick="changePassword()">ХАДГАЛАХ</button>
          </div>
        </div>
      </div>
    </section>

    <!-- LOGIN -->
    <section id="tab-login" class="tab hidden">
      <div class="card" style="max-width:420px;margin:40px auto">
        <div style="font-weight:900;font-size:18px;margin-bottom:10px;color:#0f172a">PPE LOGIN</div>
        <div style="display:grid;gap:10px">
          <input id="login-code" placeholder="Код" />
          <input id="login-pass" type="password" placeholder="Нууц үг" />
          <button class="btn-primary" onclick="login()">НЭВТРЭХ</button>
          <div style="font-size:11px;color:#64748b;font-weight:700">Admin demo: admin / 12345</div>
        </div>
      </div>
    </section>
  </main>

  <script src="./app.js?v=20260304"></script>
</body>
</html>
