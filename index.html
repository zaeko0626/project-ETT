<!doctype html>
<html lang="mn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ETT PPE SYSTEM</title>

  <!-- Main CSS -->
  <link rel="stylesheet" href="./styles.css?v=20260304" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>

<body>
  <!-- Loading Overlay -->
  <div id="loading-overlay" class="hidden">
    <div class="loader-card">
      <div class="loader-title">ТҮР ХҮЛЭЭНЭ ҮҮ...</div>
      <div class="loader-excavator">
        <div class="track"></div>
        <div class="excavator">⛏️</div>
      </div>
    </div>
  </div>

  <!-- In-page Modal -->
  <div id="modal-overlay" class="hidden" onclick="closeModal()">
    <div class="modal-card" onclick="event.stopPropagation()">
      <div class="modal-header">
        <div id="modal-title" class="modal-title">Modal</div>
        <button class="modal-x" onclick="closeModal()" aria-label="Close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div id="modal-body" class="modal-body"></div>
    </div>
  </div>

  <!-- Sidebar overlay -->
  <div id="sidebar-overlay" onclick="closeSidebar()"></div>

  <!-- Sidebar -->
  <aside id="sidebar">
    <div class="sidebar-inner">
      <div class="sidebar-scroll">
        <!-- User Card -->
        <div class="sb-card">
          <div class="sb-name" id="sb-name">ETT PPE SYSTEM</div>
          <div class="sb-id" id="sb-id"></div>
          <div class="sb-role" id="sb-role"></div>
          <div class="sb-extra" id="sb-extra"></div>
        </div>

        <div style="margin-top:12px;font-weight:900;font-size:11px;letter-spacing:.08em;text-transform:uppercase;color:#93c5fd">
          Цэс
        </div>

        <!-- Orders -->
        <button class="nav-btn active" id="nav-orders" onclick="showTab('orders', this)">
          <i class="fa-solid fa-list-check"></i>
          <div class="nav-text">Жагсаалт</div>
        </button>

        <!-- Request (USER only) -->
        <button class="nav-btn" id="nav-request" onclick="showTab('request', this)">
          <i class="fa-solid fa-file-circle-plus"></i>
          <div class="nav-text">Хүсэлт гаргах</div>
        </button>

        <!-- Items (ADMIN only) -->
        <button class="nav-btn" id="nav-items" onclick="showTab('items', this)">
          <i class="fa-solid fa-boxes-stacked"></i>
          <div class="nav-text">Барааны мэдээлэл</div>
        </button>

        <!-- Employees (ADMIN only) -->
        <button class="nav-btn" id="nav-employees" onclick="showTab('employees', this)">
          <i class="fa-solid fa-users"></i>
          <div class="nav-text">Ажилтны мэдээлэл</div>
        </button>

        <!-- Profile/Password (USER only) -->
        <button class="nav-btn" id="nav-profile" onclick="showTab('profile', this)">
          <i class="fa-solid fa-key"></i>
          <div class="nav-text">Нууц үг</div>
        </button>
      </div>

      <!-- Logout at bottom -->
      <div class="sidebar-footer">
        <button class="logout-btn" onclick="logout()">
          <i class="fa-solid fa-right-from-bracket"></i>
          ГАРАХ
        </button>
      </div>
    </div>
  </aside>

  <!-- Login Page -->
  <section id="login-page">
    <div class="scroll-area" style="display:flex;align-items:center;justify-content:center">
      <div class="card" style="max-width:420px;width:100%">
        <div style="font-weight:900;font-size:18px;color:#0f172a;margin-bottom:8px">ETT PPE SYSTEM</div>
        <div style="font-size:12px;font-weight:800;color:#64748b;margin-bottom:14px">
          Нэвтрэх код, нууц үгээ оруулна уу
        </div>

        <div style="display:grid;gap:10px">
          <div>
            <span class="filter-label">Код</span>
            <input id="login-user" placeholder="Жишээ нь: 12345" />
          </div>
          <div>
            <span class="filter-label">Нууц үг</span>
            <input id="login-pass" type="password" placeholder="••••••••" />
          </div>
          <button class="btn-primary" onclick="handleLogin()">НЭВТРЭХ</button>
          <div style="font-size:11px;font-weight:700;color:#94a3b8">
            Admin demo: <b>admin / 12345</b>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Page -->
  <section id="main-page" class="hidden">
    <!-- Header -->
    <header class="app-header">
      <button class="header-btn" onclick="toggleSidebar()">
        <i class="fa-solid fa-bars"></i>
      </button>

      <div class="app-title">ETT PPE SYSTEM</div>

      <button class="header-btn refresh-btn" onclick="refreshData()">
        <i class="fa-solid fa-rotate"></i>
        <span class="refresh-text">СЭРГЭЭХ</span>
      </button>
    </header>

    <!-- Content -->
    <main class="scroll-area">

      <!-- ===================== -->
      <!-- TAB: ORDERS (Жагсаалт) -->
      <!-- ===================== -->
      <section id="tab-orders" class="tab-content">
        <div class="tab-top">
          <div class="tab-title">ЖАГСААЛТ</div>
        </div>

        <!-- Filters (3 мөр layout: 1) Төлөв,Бараа,Он,Сар 2) Газар,Хэлтэс,Ээлж 3) Нэр/Код/Албан тушаал + Цэвэрлэх) -->
        <div class="card card-compact">
          <div class="filters-grid">
            <div class="filter-group">
              <span class="filter-label">Төлөв</span>
              <select id="filter-status"></select>
            </div>
            <div class="filter-group">
              <span class="filter-label">Бараа</span>
              <select id="filter-item"></select>
            </div>
            <div class="filter-group">
              <span class="filter-label">Он</span>
              <select id="filter-year"></select>
            </div>
            <div class="filter-group">
              <span class="filter-label">Сар</span>
              <select id="filter-month"></select>
            </div>

            <div class="filter-group">
              <span class="filter-label">Газар</span>
              <select id="filter-place" onchange="onPlaceChange()"></select>
            </div>
            <div class="filter-group">
              <span class="filter-label">Хэлтэс</span>
              <select id="filter-dept"></select>
            </div>
            <div class="filter-group">
              <span class="filter-label">Ээлж</span>
              <select id="filter-shift"></select>
            </div>

            <div class="filter-group">
              <span class="filter-label">Нэрээр хайх</span>
              <input id="search-name" placeholder="Жишээ нь: Бат" oninput="applyFilters()" />
            </div>
            <div class="filter-group">
              <span class="filter-label">Кодоор хайх</span>
              <input id="search-code" placeholder="Жишээ нь: 12345" oninput="applyFilters()" />
            </div>
            <div class="filter-group">
              <span class="filter-label">Албан тушаал</span>
              <input id="search-role" placeholder="Жишээ нь: Машинист" oninput="applyFilters()" />
            </div>

            <div class="filter-group">
              <span class="filter-label">&nbsp;</span>
              <button class="btn-mini edit" onclick="clearOrderFilters()">ЦЭВЭРЛЭХ</button>
            </div>
          </div>
        </div>

        <div id="orders-list-container"></div>
      </section>

      <!-- ===================== -->
      <!-- TAB: REQUEST (User only) -->
      <!-- ===================== -->
      <section id="tab-request" class="tab-content hidden">
        <div class="tab-top">
          <div class="tab-title">ШИНЭ ХҮСЭЛТ</div>
        </div>

        <div class="card">
          <div class="form-grid" style="grid-template-columns:1fr 1fr 1fr 220px">
            <div>
              <span class="filter-label">Бараа</span>
              <select id="req-item" onchange="updateSizeOptions()"></select>
            </div>
            <div>
              <span class="filter-label">Хэмжээ</span>
              <select id="req-size"></select>
            </div>
            <div>
              <span class="filter-label">Тоо</span>
              <input id="req-qty" type="number" min="1" value="1" />
            </div>
            <div style="display:flex;align-items:flex-end">
              <button class="btn-primary" onclick="submitOrder?.()">ИЛГЭЭХ</button>
            </div>
          </div>
        </div>
      </section>

      <!-- ===================== -->
      <!-- TAB: ITEMS (Admin only) -->
      <!-- ===================== -->
      <section id="tab-items" class="tab-content hidden">
        <div class="tab-top">
          <div class="tab-title">БАРААНЫ МЭДЭЭЛЭЛ</div>
          <div id="items-count" style="font-weight:900;color:#64748b"></div>
        </div>

        <!-- Add item -->
        <div class="card card-add-item">
          <div style="display:flex;gap:12px;align-items:center">
            <div class="add-icon"><i class="fa-solid fa-plus"></i></div>
            <div style="flex:1">
              <div class="filter-label" style="font-size:10px;color:#0f172a;margin:0 0 6px 0">Бараа нэмэх</div>
              <div class="form-grid" style="grid-template-columns:1fr 1fr 180px">
                <input id="new-item-name" placeholder="Жишээ нь: Гутал" />
                <input id="new-item-sizes" placeholder="Жишээ нь: 38,39,40" />
                <button class="btn-mini edit" onclick="addItem?.()">НЭМЭХ</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Filter item -->
        <div class="card card-compact">
          <div class="form-grid" style="grid-template-columns:1fr 180px">
            <div>
              <span class="filter-label">Бараа шүүх</span>
              <select id="items-filter-name" onchange="renderItemsList?.()"></select>
            </div>
            <div style="display:flex;align-items:flex-end">
              <button class="btn-mini edit" onclick="clearItemsFilter()">ЦЭВЭРЛЭХ</button>
            </div>
          </div>
        </div>

        <div class="items-head">
          <div>#</div>
          <div>БАРАА</div>
          <div>РАЗМЕР</div>
          <div style="text-align:right">ҮЙЛДЭЛ</div>
        </div>

        <div id="items-list-container"></div>
      </section>

      <!-- ===================== -->
      <!-- TAB: EMPLOYEES (Admin only) -->
      <!-- ===================== -->
      <section id="tab-employees" class="tab-content hidden">
        <div class="tab-top">
          <div class="tab-title">АЖИЛТНЫ МЭДЭЭЛЭЛ</div>
          <div id="emp-count" style="font-weight:900;color:#64748b"></div>
        </div>

        <div class="card card-add-item">
          <div style="display:flex;gap:12px;align-items:center">
            <div class="add-icon"><i class="fa-solid fa-user-plus"></i></div>
            <div style="flex:1">
              <div class="filter-label" style="font-size:10px;color:#0f172a;margin:0 0 6px 0">Ажилтан нэмэх</div>
              <div class="form-grid">
                <input id="emp-code" placeholder="Код (Жишээ нь: 12345)" />
                <input id="emp-pass" placeholder="Нууц үг (default: 12345)" />
                <input id="emp-ovog" placeholder="Овог (Жишээ нь: Бат)" />
                <input id="emp-ner" placeholder="Нэр (Жишээ нь: Дорж)" />
                <input id="emp-role" placeholder="Албан тушаал" />
                <input id="emp-place" placeholder="Газар" />
                <input id="emp-dept" placeholder="Хэлтэс" />
                <select id="emp-shift"></select>
                <button class="btn-mini edit" onclick="addEmployee?.()">НЭМЭХ</button>
              </div>
            </div>
          </div>
        </div>

        <div class="card card-compact">
          <div class="filters-grid" style="grid-template-columns:repeat(4,minmax(0,1fr))">
            <div class="filter-group">
              <span class="filter-label">Албан тушаал</span>
              <input id="emp-search-role" placeholder="Жишээ нь: Машинист" oninput="renderEmployeesList?.()" />
            </div>
            <div class="filter-group">
              <span class="filter-label">Газар</span>
              <input id="emp-search-place" placeholder="Жишээ нь: Уурхай" oninput="renderEmployeesList?.()" />
            </div>
            <div class="filter-group">
              <span class="filter-label">Хэлтэс</span>
              <input id="emp-search-dept" placeholder="Жишээ нь: Засвар" oninput="renderEmployeesList?.()" />
            </div>
            <div class="filter-group">
              <span class="filter-label">Ээлж</span>
              <select id="emp-search-shift" onchange="renderEmployeesList?.()"></select>
            </div>
          </div>
        </div>

        <div id="employees-list-container"></div>
      </section>

      <!-- ===================== -->
      <!-- TAB: PROFILE/PASSWORD (User only) -->
      <!-- ===================== -->
      <section id="tab-profile" class="tab-content hidden">
        <div class="tab-top">
          <div class="tab-title">НУУЦ ҮГ</div>
        </div>

        <div class="card">
          <div style="font-weight:900;color:#0f172a;margin-bottom:10px">Нууц үг солих</div>
          <div style="font-size:12px;font-weight:800;color:#64748b">
            Энэ хэсгийг user талд ашиглана. (Admin дээр цэс харагдахгүй)
          </div>
        </div>
      </section>

    </main>
  </section>

  <!-- JS -->
  <script src="./app.js?v=20260304"></script>
</body>
</html>
